$ErrorActionPreference = 'Stop'

#
# Add-Migration
#

Register-TabExpansion Generate-R4MVC @{
    Project = { GetProjects }
}

<#
.SYNOPSIS
    Runs the R4MVC code generation.

.DESCRIPTION
    Runs the R4MVC code generation.

.PARAMETER Project
    The project to use.
#>
function Generate-R4MVC
{
    [CmdletBinding(PositionalBinding = $false)]
    param(
        [string] $Project)

    $dteProject = GetProject $Project
    $r4mvcPath = Join-Path (Split-Path $PSCommandPath) "dotnet-r4mvc.exe"

    & $r4mvcPath $dteProject.FullName
}


#
# (Private Helpers)
#

function GetProject($projectName)
{
    if (!$projectName)
    {
        return Get-Project
    }

    return Get-Project $projectName
}

# SIG # Begin signature block
# MIIPngYJKoZIhvcNAQcCoIIPjzCCD4sCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQU/CN4IFszH2QaisGToV7NUDFs
# CNagggvdMIIF2DCCA8CgAwIBAgIQbDvSft08lJ6Vjiips8dXoDANBgkqhkiG9w0B
# AQsFADB9MQswCQYDVQQGEwJJTDEWMBQGA1UEChMNU3RhcnRDb20gTHRkLjErMCkG
# A1UECxMiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNhdGUgU2lnbmluZzEpMCcGA1UE
# AxMgU3RhcnRDb20gQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTUxMjE2MDEw
# MDA1WhcNMzAxMjE2MDEwMDA1WjB1MQswCQYDVQQGEwJJTDEWMBQGA1UEChMNU3Rh
# cnRDb20gTHRkLjEpMCcGA1UECxMgU3RhcnRDb20gQ2VydGlmaWNhdGlvbiBBdXRo
# b3JpdHkxIzAhBgNVBAMTGlN0YXJ0Q29tIENsYXNzIDIgT2JqZWN0IENBMIIBIjAN
# BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuRQEWPeyxYYsCDJgrQgmwIF3uWgZ
# 2RUrHRhp5NoalgWXLmR5Gqk9UTNa0Hdq9AKTQcOOunAbq9h7dG+Y6Ne5qT5odqSJ
# oCKsF9Yp+Lu4YZ/SB9BmDjBHICtwAh7+cwkccTS14n6prKin8Y46QAZ2ksr3eGzv
# WAVzfX+DUOmiVQLjAK6Wp8bCZHvj+FhAlS5Ne7/dggDeSVWnMyPm2k/5YKOTVXEx
# JJaAlYkmyH1OiC3soTkkGb6aJjGJPHiaiNJ4pjkySX5l2p4DQ7K1/J6ft5Vw9Puq
# wmYrF0ViGnn38kzB2d9UI9Q+dFmHUbV+cnr+FoGl6CiUDd5ZIF1HMrb8hwIDAQAB
# o4IBWjCCAVYwDgYDVR0PAQH/BAQDAgEGMBMGA1UdJQQMMAoGCCsGAQUFBwMDMBIG
# A1UdEwEB/wQIMAYBAf8CAQAwMgYDVR0fBCswKTAnoCWgI4YhaHR0cDovL2NybC5z
# dGFydHNzbC5jb20vc2ZzY2EuY3JsMGYGCCsGAQUFBwEBBFowWDAkBggrBgEFBQcw
# AYYYaHR0cDovL29jc3Auc3RhcnRzc2wuY29tMDAGCCsGAQUFBzAChiRodHRwOi8v
# YWlhLnN0YXJ0c3NsLmNvbS9jZXJ0cy9jYS5jcnQwHQYDVR0OBBYEFD5ik5rXxxnu
# Po9JEIVVFSDjlIQcMB8GA1UdIwQYMBaAFE4L7xqkQFulF2mHMMo0aEPQQa7yMD8G
# A1UdIAQ4MDYwNAYEVR0gADAsMCoGCCsGAQUFBwIBFh5odHRwOi8vd3d3LnN0YXJ0
# c3NsLmNvbS9wb2xpY3kwDQYJKoZIhvcNAQELBQADggIBAGOlPNWzbSco2Ou6U68w
# C+pKXRLV+ZrKcPpMY4zXTVR+RupS54WhJCManab2P1ncPlHTbRMbPjfHnyj0sIdp
# vwcV49n0nizMF3MBxaKJEnBBEfHs9Krgjc4qKjR2nOywlzxJ0M27RthR5XjyjQ1o
# fHlOisYgMzcyKyMT7YYpxxoC0wTgAh0DNmE5Q/GKFOaDd3S5gTqrR9AQzGaC3IxC
# KBFtcwvk51W98lNRtMbm+oJze5T+dL2wIhyWK58sEIl2paAVfAfWGH3umYL46scL
# n8BXDFchN1Jgrg07DqY6gxCqSdubPhVHZInuVagktWmrnS6N9V/vVLz+OaX4Mkas
# 8n1J1RIR+GV8ZQVmTM49l6L+fpv/h95MWLhQOcXanbIY/2cdNEuz5AkhfvDNTQnL
# xYEMIyMOtW2QIwwZdz92vMTU17G9goxXYjSm09yw+iBniH9G/xGz39BV3bwa8ZtK
# HzDoZ54HT6JT2AraDhrWTwFXv8Xrvv2cir+k0h5bIWlDtImH7Jm152edb77f5JI8
# JrPf6jxcUrhNH4xHxe2kGs8ERA39oYlT0dKQIb0obTN6FOF63hBRFFhGB7NuX2Fe
# FjJsZFCkoJkpsEauObb7Rh+C02+fnHfoi6ivKwUC9BOsWlI4xn7GMe27niL6k7wp
# K0L6MTG5/6gxwosqaMA1aukwMIIF/TCCBOWgAwIBAgIQQD1RFGCUSG0U6jku4AwB
# JDANBgkqhkiG9w0BAQsFADB1MQswCQYDVQQGEwJJTDEWMBQGA1UEChMNU3RhcnRD
# b20gTHRkLjEpMCcGA1UECxMgU3RhcnRDb20gQ2VydGlmaWNhdGlvbiBBdXRob3Jp
# dHkxIzAhBgNVBAMTGlN0YXJ0Q29tIENsYXNzIDIgT2JqZWN0IENBMB4XDTE3MDIy
# MDEwMTI0NVoXDTE5MDIyMDEwMTI0NVowaTELMAkGA1UEBhMCR0IxFzAVBgNVBAgM
# DkdyZWF0ZXIgTG9uZG9uMQ8wDQYDVQQHDAZMb25kb24xFzAVBgNVBAoMDkFydGlv
# bSBDaGlsYXJ1MRcwFQYDVQQDDA5BcnRpb20gQ2hpbGFydTCCAiIwDQYJKoZIhvcN
# AQEBBQADggIPADCCAgoCggIBALAxzmi2CdfYurIIlJtlWDkOmpsqpKMZVz0yuYEC
# nyWMxfFrTPkf+L4uZ2USw/eiOxMayH/AEOPDYbBop9JvXtjVm2bUVDu7VZVwv2Lc
# zLztuYSlym5ueftEdN8SYrDCJnD8tK/U822NHkM2rVpDQikByOFSIVG/LN+NtYi3
# F5yHTglJovw+XQ+h/DepOaIWVjKnZxvcY1IWc9uT/RzzrLYTPe2BS9+mKkBhbonI
# HT+Fxh+wuGYN1tLATOyuOZey/4L73JHlev6f40GFQEgCQF1yURROteHIoWI3Ltdr
# 0pIwnwMUJgQLluaSdMD+0gnI6WOF8eSKFPOXTT2MUsT1jxKBpoEqCRjTJgln7cpp
# ey6ayajnw7iuLt75H03xxp/e33tyoyiPLOh6rc12XlgWE24OEAUNYWXJyLIwlxU0
# ZEtTXMgJ1AEH6Qm6JqSmiKkBU4kl+bUuq7N0Gi9crJUNnBd2wb+/MWboD/uQbjHs
# ZYV+KAKKumtd0tPGQj5rB0G5mevkxP62wYhkHBwcCTr905g+aZUGYxLdqr3gRTpp
# 9pGy3WXucZb2xYPzA7rRT0LCs9Od0YESiYWX5vwFeYVDu44UKm7ye6yUJrQ2ArCD
# kyU/qqhRD5Fnl6p9LMbXMfVy1asrSDkV41IG7Crtx/uOgrzPxbmgGRYzAq2HPMwp
# Kc1pAgMBAAGjggGTMIIBjzAOBgNVHQ8BAf8EBAMCB4AwEwYDVR0lBAwwCgYIKwYB
# BQUHAwMwCQYDVR0TBAIwADAdBgNVHQ4EFgQUxZVx1iErde2NomklI/9WXy7p2b8w
# HwYDVR0jBBgwFoAUPmKTmtfHGe4+j0kQhVUVIOOUhBwwbQYIKwYBBQUHAQEEYTBf
# MCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5zdGFydHNzbC5jb20wNwYIKwYBBQUH
# MAKGK2h0dHA6Ly9haWEuc3RhcnRzc2wuY29tL2NlcnRzL3NjYS5jb2RlMi5jcnQw
# NgYDVR0fBC8wLTAroCmgJ4YlaHR0cDovL2NybC5zdGFydHNzbC5jb20vc2NhLWNv
# ZGUyLmNybDAjBgNVHRIEHDAahhhodHRwOi8vd3d3LnN0YXJ0c3NsLmNvbS8wUQYD
# VR0gBEowSDAIBgZngQwBBAEwPAYLKwYBBAGBtTcBAgUwLTArBggrBgEFBQcCARYf
# aHR0cHM6Ly93d3cuc3RhcnRzc2wuY29tL3BvbGljeTANBgkqhkiG9w0BAQsFAAOC
# AQEAZb03l3+SiyzzfDEkxwCoRWKwiGr7VoeiKIqVWlLZBdaJyB5ab6/NyK+y0zkb
# +oHbakG0akLo/Jn7LRmu8GyRPNA2XgLL+4HmyyuZ3tk+ClEA9ewzoGpLWjv0/N+6
# w+6b309SQu9Q5LdfxdoudZbuVxBxjuz/lRyYK6iCP6ddRnJvPhwSfyARRWJTU6iU
# fX0EthO1r+qMXAXsTtJw5QPfEuK1fhq9y9aVpK0x/FPk1aYr+PELKGbXkfG7cDUi
# s0YabaxD7odeVFTXYN/HYprABxVFAWFQ53lQG2MgE/gfL/jvygs0L9T0hPi4QnlG
# B0qmRMi7TGJGqVntld8cTr/E5zGCAyswggMnAgEBMIGJMHUxCzAJBgNVBAYTAklM
# MRYwFAYDVQQKEw1TdGFydENvbSBMdGQuMSkwJwYDVQQLEyBTdGFydENvbSBDZXJ0
# aWZpY2F0aW9uIEF1dGhvcml0eTEjMCEGA1UEAxMaU3RhcnRDb20gQ2xhc3MgMiBP
# YmplY3QgQ0ECEEA9URRglEhtFOo5LuAMASQwCQYFKw4DAhoFAKB4MBgGCisGAQQB
# gjcCAQwxCjAIoAKAAKECgAAwGQYJKoZIhvcNAQkDMQwGCisGAQQBgjcCAQQwHAYK
# KwYBBAGCNwIBCzEOMAwGCisGAQQBgjcCARUwIwYJKoZIhvcNAQkEMRYEFAekQfT1
# j+/ozop7b2Dofscx0QyFMA0GCSqGSIb3DQEBAQUABIICAHLng33mzhyckaD8cP8o
# ayCtkuHQ5jxy0hhihNhHk3C5Rht+sJEFBvBFEz6XxqeVY4PkvQR8zV1ivlfTG11Y
# 8xyga2+cOeQFO3+O83jv1uyPCwR26XgG+s9SZpn/Wh8aKxvRwwKCwwsZtW+yrwMU
# CpORn8X0No+wZj/OmX531byQuVG5FHEUvfcSBpml50P+5p46SUolsvcyQyYz9SEM
# m8qNenmbg7lT6pbAKzwaNTGD0BR7pNzf4SrLjlEF2Qw04YGsY40XKCCIsYNPfokB
# biiyivk6VmK6SJg6vBXwO1XQjP7y/1vkezPCDW8KXqxSqmldlz6jmYXa6XS/OVIO
# /DTwzNfwgQ4HINq3T8y6noHxTaKdGeb7yarwFSXbTATZ8wuV7xU+c5YWWpe1LRJA
# wNuzVxrzsiuiHIsx10Eu6pTs7zWu09quSNehz6gHTt7Jvq9PcczyPD0ywtFiV7uz
# kaoZNccaNoGSTCaK5atQZS/9g+Up7prbaulTXjf4w+oyuuzeMd1i40aSr29k43Y/
# cztOPUfRUXBDCakk3Ge6kCX9rMZel0R3KB45rGF8CHUVZ7UZaO9tPykZ4u+5U25B
# adphro+kJjYsN9wYk0Iixhhy+JRsBxUIdhCykCJRfMf8nZSSArQvOHzmkGCvEEv9
# RL7mjx5Qq7Ck4h4n2z/BE7VI
# SIG # End signature block
